АПИ центра управления флота сопротивления.

1. Запуск сервиса.

Для запуска сервиса необходимо:

1) В папке src разместить/откорректировать файл gates.txt. 
С поставкой идет файл из задания.

2) Далее в корневом каталоге приложения запустить команду docker-compose up
Сервис по умолчанию запускается на порту 3000

2. Описание АПИ.

В АПИ используются GET запросы.

2.1 Запрос на поиск безопасного маршрута.

Запрос:

http://{АдресАПИ}:{ПортАПИ}/findGates/{НомерКорабля}/{НомерСектораНазначения}

Например:

http://116.203.138.134:3000/findGates/2/102

где 
116.203.138.134 - АдресАПИ
3000 - ПортАПИ
2 - НомерКорабля
102 - НомерСектораНазначения

Ответ:

Ответ представлен в формате JSON. Ответ содержит массив с уровнями опасности (securityLevel) и возможным маршрутом (gates) на этом уровне.

Пример для запроса http://116.203.138.134:3000/findGates/2/102

[
    {
        "securityLevel": 1,
        "gates": [7,17,22,56]
    },
    {
        "securityLevel": 2,
        "gates": [2,5,9,12,16,25,33]
    },
    {
        "securityLevel": 3,
        "gates": [1,7,16,78]
    },
    {
        "securityLevel": 4,
        "gates": [2,3,11,16,17,20,33]
    },
    {
        "securityLevel": 5,
        "gates": [5,17,33,47]
    }
]

То есть, для уровня опасности 1 безопасный маршрут к сектору  102 будет 7,17,22,56 и т.д.


2.2 Запрос на получение списка кораблей с последним запрошенным номером сектора назначения

Запрос:

http://{АдресАПИ}:{ПортАПИ}/spaceShips

Например:

http://116.203.138.134:3000/spaceShips

где
116.203.138.134 - АдресАПИ
3000 - ПортАПИ

Ответ:

Ответ представлен в формате JSON. Ответ содержит массив с номерами кораблей(_id) и номером последнего сектора (lastGate)

Пример:

[
    {
        "_id": 5,
        "__v": 0,
        "lastGate": 35
    },
    {
        "_id": 2,
        "__v": 0,
        "lastGate": 102
    }
]

То есть, запросы присылали два корабля с номерами 2 и 5. 
Корабль с номером 5 последний раз запросил сектор 35, 
корабль с номером 2 последний раз запросил сектор 102.

2.3 Запрос на получение истории запросов корабля в хронологическом порядке

Запрос:

http://{АдресАПИ}:{ПортАПИ}/spaceShips/{НомерКорабля}

Например:

http://116.203.138.134:3000/spaceShips/2

где
116.203.138.134 - АдресАПИ
3000 - ПортАПИ
2 - НомерКорабля

Ответ:

Ответ представлен в формате JSON. Ответ содержит массив с номерами кораблей(spaceShipId), 
номером последнего сектора (requestGate), 
массивом маршрутов (route) 
и датой/временем запроса(created_at). 

Если по заданному сектору нет безопасных маршрутов, то массив route будет пустой. 
Массив отсортирован по убыванию даты времени запроса.

Пример:

[
{
"_id":"5c99df53a5756d001e4d4bb9",
"spaceShipId":2,
"requestGate":102,
"route":[{"securityLevel":1,"gates":[7,17,22,56]},{"securityLevel":2,"gates":[2,5,9,12,16,25,33]},{"securityLevel":3,"gates":[1,7,16,78]},{"securityLevel":4,"gates":[2,3,11,16,17,20,33]},{"securityLevel":5,"gates":[5,17,33,47]}],
"created_at":"2019-03-26T08:14:11.855Z",
"updatedAt":"2019-03-26T08:14:11.855Z","__v":0
},
{
"_id":"5c99db7ba5756d001e4d4bb8",
"spaceShipId":2,
"requestGate":10200,
"route":[],
"created_at":"2019-03-26T07:57:47.704Z",
"updatedAt":"2019-03-26T07:57:47.704Z","__v":0
}
]

3. Рабочий тестовый сервис

Тестовый АПИ поднят по адресу 116.203.138.134 порт 3000
Вы можете проверить работоспособность всех описанных команд используя ссылки из примеров

http://116.203.138.134:3000/findGates/2/102
http://116.203.138.134:3000/spaceShips/
http://116.203.138.134:3000/spaceShips/2

4. Дальнейшее развитие сервиса.

В качестве путей развития сервиса можно предложить следующее:

- добавить авторизацию
- добавить функцию очистки истории для хранение ограниченного 
  количества запросов кораблей
- в запрос на получение истории запросов корабля добавить параметр 
  в котором задавать максимальное количество запросов в ответе
- добавить запрос о том какие корабли направляются в заданный сектор
- для запуска можно добавить параметры, которыми задавать порт для АПИ
- можно добавить АПИ для управления списком, который задан в файле gates.txt
- добавить тесты